{%- if section.blocks.size > 0 -%}
	{%- style -%}
		#shopify-section-{{- section.id -}} {
			padding-top: {{- section.settings.offset_top_mobile -}}px;
			padding-bottom: {{- section.settings.offset_bottom_mobile -}}px;
		}

		@media screen and (min-width: 768px) {
			#shopify-section-{{- section.id -}} {
				padding-top: {{- section.settings.offset_top_desktop -}}px;
				padding-bottom: {{- section.settings.offset_bottom_desktop -}}px;
			}
		}
	{%- endstyle -%}

	{%- assign label         		= section.settings.label -%}
	{%- assign heading          	= section.settings.heading -%}
	{%- assign enable_arrows    	= section.settings.enable_arrows -%}
	{%- assign enable_autoplay  	= section.settings.enable_autoplay -%}
	{%- assign image_aspect_ratio   = section.settings.image_aspect_ratio -%}
	{%- assign image_crop   		= section.settings.image_crop -%}
	{%- assign autoplay_speed   	= section.settings.autoplay_speed -%}
	{%- assign design   			= settings.design -%}

	{%- capture old_layout -%}
		{{- 'gallery-carousel.build.css' | asset_url | stylesheet_tag -}}

		<section class="gallery-carousel js-gallery-carousel js-animate" id="gallery-carousel--{{ section.id }}">
			{%- if label != blank or heading != blank -%}
				<div class="gallery-carousel__header">
					{%- if label != blank -%}
						<div class="gallery-carousel__label">
							{{- label -}}
						</div>
					{%- endif -%}

					{%- if heading != blank -%}
						<h2 class="gallery-carousel__heading h2">
							{{- heading -}}
						</h2>
					{%- endif -%}
				</div>
			{%- endif -%}

			<div
				class="gallery-carousel__items-container swiper-container js-gallery-carousel-container"
				{%- if enable_autoplay == true -%}
					data-autoplay-speed="{{ autoplay_speed | times: 1000 }}"
				{%- endif -%}
				data-layout-standard
			>
				<div class="gallery-carousel__items-wrapper swiper-wrapper">
					{%- for block in section.blocks -%}
						{%- assign image = block.settings.image -%}
						{%- assign link = block.settings.link -%}
						{%- assign is_lazy = true -%}

						{% if section.index == 1 or forloop.index > 1 %}
							{% assign is_lazy = false %}
						{% endif %}

						{% render 'gallery-carousel-slide',
							image: image,
							link: link,
							image_aspect_ratio: image_aspect_ratio,
							image_crop: image_crop,
							is_lazy: is_lazy
						%}
					{%- endfor -%}

					{% if section.blocks.size < 6 and section.blocks.size > 1 %}
						{%- for i in (1..section.blocks.size) -%}
							{%- assign image = section.blocks[forloop.index0].settings.image -%}
							{%- assign link = section.blocks[forloop.index0].settings.link -%}
							{%- assign is_lazy = true -%}

							{% if section.index == 1 or forloop.index > 1 %}
								{% assign is_lazy = false %}
							{% endif %}

							{% render 'gallery-carousel-slide',
								image: image,
								link: link,
								image_aspect_ratio: image_aspect_ratio,
								image_crop: image_crop,
								is_lazy: is_lazy
							%}
						{%- endfor -%}
					{% elsif section.blocks.size == 1 %}
						{%- assign image = section.blocks[0].settings.image -%}
						{%- assign link  = section.blocks[0].settings.link -%}
						{%- assign is_lazy = true -%}

						{% if section.index == 1 or forloop.index > 1 %}
							{% assign is_lazy = false %}
						{% endif %}

						{%- for i in (1..5) -%}
							{% render 'gallery-carousel-slide',
								image: image,
								link: link,
								image_aspect_ratio: image_aspect_ratio,
								image_crop: image_crop,
								is_lazy: is_lazy
							%}
						{%- endfor -%}
					{% endif %}
				</div>

				{%- if section.blocks.size > 1 and enable_arrows -%}
					<button class="swiper-button-prev gallery-carousel__button gallery-carousel__button--prev">
						{%- render 'icons-small', icon: 'arrow-left' -%}
					</button>

					<button class="swiper-button-next gallery-carousel__button gallery-carousel__button--next">
						{%- render 'icons-small', icon: 'arrow-right' -%}
					</button>
				{%- endif -%}

				<div class="swiper-pagination gallery-carousel__pagination"></div>
		</section>
	{%- endcapture -%}

	{%- if design == "alternate" -%}
		{%- render "gallery-carousel-new", section: section -%}
	{%- else -%}
		{{- old_layout -}}
	{%- endif -%}

	<script src="{{- 'component-swiper-modules.build.min.js' | asset_url -}}" defer></script>
	<script src="{{- 'section-gallery-carousel.build.min.js' | asset_url -}}" defer></script>
{%- endif -%}

{%- schema -%}
{
"name": "Gallery carousel",
"disabled_on": {
	"groups": ["header", "footer"]
},
"settings": [
	{
		"type": "text",
		"id": "label",
		"label": "Label"
	},
	{
		"type": "text",
		"id": "heading",
		"label": "Heading",
		"default": "Gallery Carousel"
	},
	{
		"type": "select",
		"id": "image_aspect_ratio",
		"label": "Image aspect ratio",
		"options": [
			{
				"value": "square",
				"label": "Square"
			},
			{
				"value": "portrait",
				"label": "Portrait"
			}
		],
		"default": "square"
	},
	{
		"type": "select",
		"id": "image_crop",
		"label": "Image crop",
		"options": [
			{
				"value": "top",
				"label": "Top"
			},
			{
				"value": "center",
				"label": "Center"
			},
			{
				"value": "bottom",
				"label": "Bottom"
			}
		],
		"default": "center",
		"info": "The setting allows you to specify which part of the image to show if the specified dimensions result in an aspect ratio that differs from the original."
	},
	{
		"type": "header",
		"content": "Slideshow settings"
	},
	{
		"type": "checkbox",
		"id": "enable_arrows",
		"label": "Show arrows",
		"info": "Shown only on the desktop",
		"default": false
	},
	{
		"type": "checkbox",
		"id": "enable_autoplay",
		"label": "Autoplay",
		"default": true
	},
	{
		"type": "range",
		"id": "autoplay_speed",
		"min": 3,
		"max": 15,
		"step": 1,
		"unit": "s",
		"label": "Autoplay speed",
		"default": 3
	},
	{
		"type": "header",
		"content": "Layout"
	},
	{
		"type": "range",
		"id": "offset_top_desktop",
		"min": 0,
		"max": 100,
		"step": 1,
		"unit": "px",
		"label": "Desktop offset top",
		"default": 0
	},
	{
		"type": "range",
		"id": "offset_bottom_desktop",
		"min": 0,
		"max": 100,
		"step": 1,
		"unit": "px",
		"label": "Desktop offset bottom",
		"default": 0
	},
	{
		"type": "range",
		"id": "offset_top_mobile",
		"min": 0,
		"max": 100,
		"step": 1,
		"unit": "px",
		"label": "Mobile offset top",
		"default": 0
	},
	{
		"type": "range",
		"id": "offset_bottom_mobile",
		"min": 0,
		"max": 100,
		"step": 1,
		"unit": "px",
		"label": "Mobile offset bottom",
		"default": 0
	}
],
"blocks": [
	{
		"name": "Slide",
		"type": "slide",
		"settings": [
			{
				"type": "image_picker",
				"id": "image",
				"label": "Image",
				"info": "1130 x 1130px recommended"
			},
			{
				"type": "url",
				"id": "link",
				"label": "Link"
			}
		]
	}
],
"presets": [
	{
		"name": "Gallery carousel",
		"settings": {},
		"blocks": [
			{
				"type": "slide"
			},
			{
				"type": "slide"
			},
			{
				"type": "slide"
			},
			{
				"type": "slide"
			},
			{
				"type": "slide"
			}
		]
	}
]
}
{%- endschema -%}
